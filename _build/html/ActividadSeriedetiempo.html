
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Actividad Serie de tiempo &#8212; Actividad Series de tiempo - Visualización de Datos</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ActividadSeriedetiempo';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Actividad Series de Tiempo - Walmart" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.jpg" class="logo__image only-light" alt="Actividad Series de tiempo - Visualización de Datos - Home"/>
    <script>document.write(`<img src="_static/logo.jpg" class="logo__image only-dark" alt="Actividad Series de tiempo - Visualización de Datos - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Actividad Series de Tiempo - Walmart
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Actividad Serie de tiempo</strong></a></li>





</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FActividadSeriedetiempo.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/ActividadSeriedetiempo.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Actividad Serie de tiempo</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>Actividad Serie de tiempo</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-y-analisis-descriptivo"><strong>Datos y análisis descriptivo</strong></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-arima"><strong>Modelo ARIMA</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estacionariedad"><strong>Estacionariedad</strong></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#aic"><strong>AIC</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#residuos"><strong>Residuos</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-arima-con-aic-7-dias"><strong>modelo ARIMA con aic (7 días)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rolling-forecast"><strong>rolling forecast</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sin-rolling-forecast"><strong>Sin rolling forecast</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-arima-con-aic-14-dias"><strong>Modelo ARIMA con aic (14 días)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#con-rolling-forecast"><strong>Con rolling forecast</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><strong>sin rolling forecast</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-arima-con-aic-21-dias"><strong>Modelo ARIMA con aic (21 días)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><strong>Con rolling forecast</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>Sin rolling forecast</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-arima-con-aic-28-dias"><strong>Modelo ARIMA con aic (28 días)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><strong>Con rolling forecast</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><strong>Sin rolling forecast</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bic"><strong>BIC</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-arima-con-bic-7-dias"><strong>Modelo ARIMA con bic (7 días)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><strong>Con rolling forecast</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><strong>Sin rolling forecast</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-arima-con-bic-14-dias"><strong>Modelo ARIMA con bic (14 días)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><strong>Con rolling forecast</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><strong>Sin rolling forecast</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-arima-con-bic-21-dias"><strong>Modelo ARIMA con bic (21 días)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><strong>Con rolling forecast</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11"><strong>Sin rolling forecast</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-arima-con-bic-28-dias"><strong>Modelo ARIMA con bic (28 días)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"><strong>Con rolling forecast</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13"><strong>Sin rolling forecast</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hqic"><strong>HQIC</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-errores"><strong>Metricas de errores</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-error-usando-rolling-para-el-aic"><strong>Métricas de error usando rolling para el aic</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-error-sin-usar-rolling-para-el-aic"><strong>Métricas de error sin usar rolling para el aic</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-error-usando-rolling-para-el-bic"><strong>Métricas de error usando rolling para el bic</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-error-sin-usar-rolling-para-el-bic"><strong>Métricas de error sin usar rolling para el bic</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlacion-entre-la-observacion-real-y-prediccion-del-test-en-aic"><strong>Correlación entre la observación real y predicción del test en AIC</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlacion-entre-la-observacion-real-y-prediccion-del-test-en-bic"><strong>Correlación entre la observación real y predicción del test en BIC</strong></a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="actividad-serie-de-tiempo">
<h1><strong>Actividad Serie de tiempo</strong><a class="headerlink" href="#actividad-serie-de-tiempo" title="Link to this heading">#</a></h1>
<p>Gwyneth Blanco Durán</p>
<section id="datos-y-analisis-descriptivo">
<h2><strong>Datos y análisis descriptivo</strong><a class="headerlink" href="#datos-y-analisis-descriptivo" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">yfinance</span> <span class="k">as</span> <span class="nn">yf</span>
<span class="kn">from</span> <span class="nn">yahoo_fin.stock_info</span> <span class="kn">import</span> <span class="n">get_data</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">adfuller</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">log</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.arima.model</span> <span class="kn">import</span> <span class="n">ARIMA</span>
<span class="kn">import</span> <span class="nn">pmdarima</span> <span class="k">as</span> <span class="nn">pm</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_predict</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>Para este ejercicio, se utilizaran los datos proporcionados para la empresa estadounidense Walmart.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">walmartacc</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">Ticker</span><span class="p">(</span><span class="s2">&quot;WMT&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;paper&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stock</span> <span class="o">=</span> <span class="s1">&#39;WMT&#39;</span>
<span class="n">resolution</span> <span class="o">=</span> <span class="s1">&#39;1d&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Tomaremos los datos de hace 10 años atras, por lo tanto, tomaremos las observaciones desde el año 2014.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">date_format</span><span class="p">(</span><span class="n">date_h</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">date_h</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Observamos el contenido de nuestra base de datos</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">walmartacc_df</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">stock</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">resolution</span><span class="p">,</span> <span class="n">index_as_date</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">walmartacc_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>adjclose</th>
      <th>volume</th>
      <th>ticker</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2014-01-02</td>
      <td>26.240000</td>
      <td>26.490000</td>
      <td>26.166668</td>
      <td>26.303333</td>
      <td>21.054293</td>
      <td>20634000</td>
      <td>WMT</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2014-01-03</td>
      <td>26.270000</td>
      <td>26.376667</td>
      <td>26.173332</td>
      <td>26.216667</td>
      <td>20.984922</td>
      <td>14872200</td>
      <td>WMT</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2014-01-06</td>
      <td>26.286667</td>
      <td>26.303333</td>
      <td>25.930000</td>
      <td>26.070000</td>
      <td>20.867525</td>
      <td>21840600</td>
      <td>WMT</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2014-01-07</td>
      <td>26.056667</td>
      <td>26.283333</td>
      <td>25.973333</td>
      <td>26.150000</td>
      <td>20.931561</td>
      <td>15036900</td>
      <td>WMT</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2014-01-08</td>
      <td>26.166668</td>
      <td>26.170000</td>
      <td>25.866667</td>
      <td>25.943333</td>
      <td>20.766130</td>
      <td>17865600</td>
      <td>WMT</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Realizamos un analisis de las variables numéricas que estan en nuestros datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">walmartacc_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>adjclose</th>
      <th>volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2698</td>
      <td>2698.000000</td>
      <td>2698.000000</td>
      <td>2698.000000</td>
      <td>2698.000000</td>
      <td>2698.000000</td>
      <td>2.698000e+03</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2019-05-12 04:25:47.813195008</td>
      <td>37.309190</td>
      <td>37.603471</td>
      <td>37.032025</td>
      <td>37.321139</td>
      <td>34.622624</td>
      <td>2.384270e+07</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2014-01-02 00:00:00</td>
      <td>18.796667</td>
      <td>19.020000</td>
      <td>18.766666</td>
      <td>18.806667</td>
      <td>15.728047</td>
      <td>6.287500e+06</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2016-09-06 06:00:00</td>
      <td>25.587500</td>
      <td>25.715000</td>
      <td>25.457500</td>
      <td>25.590000</td>
      <td>21.199251</td>
      <td>1.625092e+07</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2019-05-13 12:00:00</td>
      <td>34.555000</td>
      <td>34.951666</td>
      <td>34.311666</td>
      <td>34.725000</td>
      <td>31.463522</td>
      <td>2.040660e+07</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2022-01-12 18:00:00</td>
      <td>47.280833</td>
      <td>47.659166</td>
      <td>46.931667</td>
      <td>47.311666</td>
      <td>45.288038</td>
      <td>2.700540e+07</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2024-09-20 00:00:00</td>
      <td>80.839996</td>
      <td>81.019997</td>
      <td>80.139999</td>
      <td>80.599998</td>
      <td>80.599998</td>
      <td>2.426943e+08</td>
    </tr>
    <tr>
      <th>std</th>
      <td>NaN</td>
      <td>12.581768</td>
      <td>12.674798</td>
      <td>12.479497</td>
      <td>12.585463</td>
      <td>13.671116</td>
      <td>1.381607e+07</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ahora, observaremos el comportamiento durante el transcurso de 10 años de nuestra serie de tiempo para la empresa Walmart.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">walmartacc_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">walmartacc_df</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4f599139a8154139f0774c6ecc41bb7beff759af7200f56a22b7b5604868eb7c.png" src="_images/4f599139a8154139f0774c6ecc41bb7beff759af7200f56a22b7b5604868eb7c.png" />
</div>
</div>
<p>Se puede observar un aumento a través de los años en el rendimiento financiero de la empresa Walmart, más adelante analizaremos si la serie es estacionaria o no.</p>
<p>Realizaremos un paso importante para el desarrollo del ejercicio; identificar los mejores parámetros para optimizar los criterios AIC, BIC y HQIC. Este proceso es fundamental, ya que elegir los parámetros óptimos ayuda a mejorar el ajuste del modelo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_scores</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ari</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">maj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
                <span class="c1"># Ajuste del modelo ARIMA</span>
                <span class="n">arima_obj</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">walmartacc_df</span><span class="p">[</span><span class="s1">&#39;adjclose&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="n">ari</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">maj</span><span class="p">))</span>
                <span class="n">arima_obj_fit</span> <span class="o">=</span> <span class="n">arima_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

                <span class="c1"># Almacenar los valores de AIC, BIC, HQIC y los parámetros</span>
                <span class="n">model_scores</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ari</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">maj</span><span class="p">,</span> <span class="n">arima_obj_fit</span><span class="o">.</span><span class="n">aic</span><span class="p">,</span> <span class="n">arima_obj_fit</span><span class="o">.</span><span class="n">bic</span><span class="p">,</span> <span class="n">arima_obj_fit</span><span class="o">.</span><span class="n">hqic</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Se realizó un dataframe con los mejores scores.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AR&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;MA&#39;</span><span class="p">,</span> <span class="s1">&#39;AIC&#39;</span><span class="p">,</span> <span class="s1">&#39;BIC&#39;</span><span class="p">,</span> <span class="s1">&#39;HQIC&#39;</span><span class="p">]</span>
<span class="n">model_scores_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">model_scores</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">model_scores_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AR</th>
      <th>D</th>
      <th>MA</th>
      <th>AIC</th>
      <th>BIC</th>
      <th>HQIC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3700.908090</td>
      <td>3718.607776</td>
      <td>3707.309187</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3702.931429</td>
      <td>3726.531011</td>
      <td>3711.466225</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>3702.903120</td>
      <td>3726.502701</td>
      <td>3711.437916</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3695.369656</td>
      <td>3724.869133</td>
      <td>3706.038151</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>3700.834886</td>
      <td>3718.533460</td>
      <td>3707.235701</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>3706.017066</td>
      <td>3729.615164</td>
      <td>3714.551486</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>3702.824196</td>
      <td>3726.422293</td>
      <td>3711.358616</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>3700.052939</td>
      <td>3729.550562</td>
      <td>3710.720965</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Se obtuvo las columnas con los mejores valores.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_aic</span> <span class="o">=</span> <span class="n">model_scores_df</span><span class="p">[</span><span class="s1">&#39;AIC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">best_bic</span> <span class="o">=</span> <span class="n">model_scores_df</span><span class="p">[</span><span class="s1">&#39;BIC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">best_hqic</span> <span class="o">=</span> <span class="n">model_scores_df</span><span class="p">[</span><span class="s1">&#39;HQIC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

<span class="c1">#mejores valores de AIC, BIC y HQIC</span>
<span class="n">best_aic_row</span> <span class="o">=</span> <span class="n">model_scores_df</span><span class="p">[</span><span class="n">model_scores_df</span><span class="p">[</span><span class="s1">&#39;AIC&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">best_aic</span><span class="p">]</span>
<span class="n">best_bic_row</span> <span class="o">=</span> <span class="n">model_scores_df</span><span class="p">[</span><span class="n">model_scores_df</span><span class="p">[</span><span class="s1">&#39;BIC&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">best_bic</span><span class="p">]</span>
<span class="n">best_hqic_row</span> <span class="o">=</span> <span class="n">model_scores_df</span><span class="p">[</span><span class="n">model_scores_df</span><span class="p">[</span><span class="s1">&#39;HQIC&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">best_hqic</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor AIC:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_aic_row</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Mejor BIC:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_bic_row</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Mejor HQIC:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_hqic_row</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejor AIC:
   AR  D  MA          AIC          BIC         HQIC
3   2  1   2  3695.369656  3724.869133  3706.038151

Mejor BIC:
   AR  D  MA          AIC         BIC         HQIC
4   1  2   1  3700.834886  3718.53346  3707.235701

Mejor HQIC:
   AR  D  MA          AIC          BIC         HQIC
3   2  1   2  3695.369656  3724.869133  3706.038151
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">min_aic_idx</span> <span class="o">=</span> <span class="n">model_scores_df</span><span class="p">[</span><span class="s1">&#39;AIC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
<span class="n">min_bic_idx</span> <span class="o">=</span> <span class="n">model_scores_df</span><span class="p">[</span><span class="s1">&#39;BIC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
<span class="n">min_hqic_idx</span> <span class="o">=</span> <span class="n">model_scores_df</span><span class="p">[</span><span class="s1">&#39;HQIC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>

<span class="c1"># Obtener los valores mínimos de AIC, BIC y HQIC</span>
<span class="n">min_aic</span> <span class="o">=</span> <span class="n">model_scores_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">min_aic_idx</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;AR&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;MA&#39;</span><span class="p">,</span> <span class="s1">&#39;AIC&#39;</span><span class="p">]]</span>
<span class="n">min_bic</span> <span class="o">=</span> <span class="n">model_scores_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">min_bic_idx</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;AR&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;MA&#39;</span><span class="p">,</span> <span class="s1">&#39;BIC&#39;</span><span class="p">]]</span>
<span class="n">min_hqic</span> <span class="o">=</span> <span class="n">model_scores_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">min_hqic_idx</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;AR&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;MA&#39;</span><span class="p">,</span> <span class="s1">&#39;HQIC&#39;</span><span class="p">]]</span>

<span class="n">mejores_modelos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Métrica&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AIC&#39;</span><span class="p">,</span> <span class="s1">&#39;BIC&#39;</span><span class="p">,</span> <span class="s1">&#39;HQIC&#39;</span><span class="p">],</span>
    <span class="s1">&#39;AR&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">min_aic</span><span class="p">[</span><span class="s1">&#39;AR&#39;</span><span class="p">],</span> <span class="n">min_bic</span><span class="p">[</span><span class="s1">&#39;AR&#39;</span><span class="p">],</span> <span class="n">min_hqic</span><span class="p">[</span><span class="s1">&#39;AR&#39;</span><span class="p">]],</span>
    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">min_aic</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">],</span> <span class="n">min_bic</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">],</span> <span class="n">min_hqic</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]],</span>
    <span class="s1">&#39;MA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">min_aic</span><span class="p">[</span><span class="s1">&#39;MA&#39;</span><span class="p">],</span> <span class="n">min_bic</span><span class="p">[</span><span class="s1">&#39;MA&#39;</span><span class="p">],</span> <span class="n">min_hqic</span><span class="p">[</span><span class="s1">&#39;MA&#39;</span><span class="p">]],</span>
    <span class="s1">&#39;Valor&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">min_aic</span><span class="p">[</span><span class="s1">&#39;AIC&#39;</span><span class="p">],</span> <span class="n">min_bic</span><span class="p">[</span><span class="s1">&#39;BIC&#39;</span><span class="p">],</span> <span class="n">min_hqic</span><span class="p">[</span><span class="s1">&#39;HQIC&#39;</span><span class="p">]]</span>
<span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mejores_modelos</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Métrica   AR    D   MA        Valor
0     AIC  2.0  1.0  2.0  3695.369656
1     BIC  1.0  2.0  1.0  3718.533460
2    HQIC  2.0  1.0  2.0  3706.038151
</pre></div>
</div>
</div>
</div>
<p>Y luego, guardamos los mejores parámetros para los diferentes criterios.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">min_aic</span> <span class="o">=</span> <span class="n">model_scores_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">min_aic_idx</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;AR&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;MA&#39;</span><span class="p">,</span> <span class="s1">&#39;AIC&#39;</span><span class="p">]]</span>
<span class="n">min_bic</span> <span class="o">=</span> <span class="n">model_scores_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">min_bic_idx</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;AR&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;MA&#39;</span><span class="p">,</span> <span class="s1">&#39;BIC&#39;</span><span class="p">]]</span>
<span class="n">min_hqic</span> <span class="o">=</span> <span class="n">model_scores_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">min_hqic_idx</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;AR&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;MA&#39;</span><span class="p">,</span> <span class="s1">&#39;HQIC&#39;</span><span class="p">]]</span>
<span class="n">best_order_aic</span> <span class="o">=</span> <span class="p">(</span><span class="n">min_aic</span><span class="p">[</span><span class="s1">&#39;AR&#39;</span><span class="p">],</span> <span class="n">min_aic</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">],</span> <span class="n">min_aic</span><span class="p">[</span><span class="s1">&#39;MA&#39;</span><span class="p">])</span>
<span class="n">best_order_bic</span> <span class="o">=</span> <span class="p">(</span><span class="n">min_bic</span><span class="p">[</span><span class="s1">&#39;AR&#39;</span><span class="p">],</span> <span class="n">min_bic</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">],</span> <span class="n">min_bic</span><span class="p">[</span><span class="s1">&#39;MA&#39;</span><span class="p">])</span>
<span class="n">best_order_hqic</span> <span class="o">=</span> <span class="p">(</span><span class="n">min_hqic</span><span class="p">[</span><span class="s1">&#39;AR&#39;</span><span class="p">],</span> <span class="n">min_hqic</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">],</span> <span class="n">min_hqic</span><span class="p">[</span><span class="s1">&#39;MA&#39;</span><span class="p">])</span>

<span class="c1"># Mostrar las variables</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor orden para AIC:&quot;</span><span class="p">,</span> <span class="n">best_order_aic</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor orden para BIC:&quot;</span><span class="p">,</span> <span class="n">best_order_bic</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor orden para HQIC:&quot;</span><span class="p">,</span> <span class="n">best_order_hqic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejor orden para AIC: (2.0, 1.0, 2.0)
Mejor orden para BIC: (1.0, 2.0, 1.0)
Mejor orden para HQIC: (2.0, 1.0, 2.0)
</pre></div>
</div>
</div>
</div>
<p>aic (2.1.2)
bic (1.2.1)
hqic (2.1.2)</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modelo-arima">
<h1><strong>Modelo ARIMA</strong><a class="headerlink" href="#modelo-arima" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">)})</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="p">);</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Series&#39;</span><span class="p">)</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">lags</span> <span class="o">=</span> <span class="mi">1900</span><span class="p">);</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">diff</span><span class="p">());</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;1st Order Differencing&#39;</span><span class="p">)</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">lags</span> <span class="o">=</span> <span class="mi">1900</span><span class="p">);</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">diff</span><span class="p">());</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;1st Order Differencing&#39;</span><span class="p">)</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">lags</span> <span class="o">=</span> <span class="mi">1900</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7871eb297170d276953ff5afa8ae7b2655d970c84653733460df2caba66f038d.png" src="_images/7871eb297170d276953ff5afa8ae7b2655d970c84653733460df2caba66f038d.png" />
</div>
</div>
<p>En la gráfica anterior se muestra la serie original junto con los gráficos de autocorrelación, que nos ayudan a determinar si la serie es estacionaria. También se incluyen los gráficos de diferenciación, que indican cuántas diferencias son necesarias para hacer la serie estacionaria.</p>
<section id="estacionariedad">
<h2><strong>Estacionariedad</strong><a class="headerlink" href="#estacionariedad" title="Link to this heading">#</a></h2>
<p>Para determinar si la serie es estacionaria, aplicaremos el test de Dickey-Fuller, el cual plantea las siguientes hipótesis, si <span class="math notranslate nohighlight">\(p-value &gt; 0.05\)</span> no rechazamos nuestra hipotesis inicial:</p>
<p><span class="math notranslate nohighlight">\(H_0\)</span> : La serie es <strong>NO</strong> estacionaria</p>
<p><span class="math notranslate nohighlight">\(H_1\)</span> : La serie es estacionaria</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ADF Statistic: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Statistic: 1.713123
p-value: 0.998160
</pre></div>
</div>
</div>
</div>
<p>el p-value es mayor al nivel de significancia del 0.05, por lo tanto, no rechazamos la hipótesis nula, es decir, la serie es NO estacionaria y procederemos a usar el modelo arima.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="aic">
<h1><strong>AIC</strong><a class="headerlink" href="#aic" title="Link to this heading">#</a></h1>
<p>Realizamos los procedimientos para el primer criterio. con los mejores parámetros obtenidos (2,1,2).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pmodel</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">walmartacc_df</span><span class="p">[</span><span class="s1">&#39;adjclose&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">)})</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">();</span>
<span class="n">plot_predict</span><span class="p">(</span><span class="n">pmodel</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ef6bfa7b9444fd4ee8045013df577e0ddc2c3f10aa8d010c31f9a5d4ff59d15f.png" src="_images/ef6bfa7b9444fd4ee8045013df577e0ddc2c3f10aa8d010c31f9a5d4ff59d15f.png" />
</div>
</div>
<p>Podemos observar que la linea azul que muestra la predicción según los valores del pasado se encuentra dentro del área sombreada, lo que puede significar que valores del futuro probablemente caeran dentro de esta región con un 95% de confianza.</p>
<section id="residuos">
<h2><strong>Residuos</strong><a class="headerlink" href="#residuos" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arima_obj_fit</span><span class="o">.</span><span class="n">plot_diagnostics</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b16b794a81a1705d9095bc99ee32cb7567fd0cc4e6a7c63ecf6122c2bd96e223.png" src="_images/b16b794a81a1705d9095bc99ee32cb7567fd0cc4e6a7c63ecf6122c2bd96e223.png" />
</div>
</div>
<p>En cuanto a los residuos, despues de analizarlos visualmente, podemos decir que se distribuyen normal, además, no son dependientes entre ellos ya que no presentan correlación.</p>
</section>
<section id="modelo-arima-con-aic-7-dias">
<h2><strong>modelo ARIMA con aic (7 días)</strong><a class="headerlink" href="#modelo-arima-con-aic-7-dias" title="Link to this heading">#</a></h2>
<p>Realizamos el modelo para predecir los ultimos 7 días</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_walmart</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="p">);</span> <span class="n">n_test_7</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">train_size_7</span> <span class="o">=</span> <span class="n">n_walmart</span> <span class="o">-</span> <span class="n">n_test_7</span>
<span class="n">train_7</span> <span class="o">=</span> <span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="p">[:</span><span class="n">train_size_7</span><span class="p">]</span>
<span class="n">dates_train_7</span> <span class="o">=</span> <span class="n">walmartacc_df</span><span class="o">.</span><span class="n">date</span><span class="p">[:</span><span class="n">train_size_7</span><span class="p">]</span>
<span class="n">test_7</span> <span class="o">=</span> <span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="p">[</span><span class="n">train_size_7</span><span class="p">:</span><span class="n">train_size_7</span> <span class="o">+</span> <span class="n">n_test_7</span><span class="p">]</span> 
<span class="n">dates_7</span> <span class="o">=</span> <span class="n">walmartacc_df</span><span class="o">.</span><span class="n">date</span><span class="p">[</span><span class="n">train_size_7</span><span class="p">:</span><span class="n">train_size_7</span> <span class="o">+</span> <span class="n">n_test_7</span><span class="p">]</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;train:&quot;</span><span class="p">,</span> <span class="n">train_7</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;test_4w:&quot;</span><span class="p">,</span> <span class="n">test_7</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>train: (2691,)
test_4w: (7,)
</pre></div>
</div>
</div>
</div>
<section id="rolling-forecast">
<h3><strong>rolling forecast</strong><a class="headerlink" href="#rolling-forecast" title="Link to this heading">#</a></h3>
<p>Realizaremos el modelo utilizando rolling y otro sin utilizarlo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">arima_rolling</span><span class="p">(</span><span class="n">history</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">best_order</span><span class="p">):</span>
    
    <span class="n">predictions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)):</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">history</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">best_order</span><span class="p">)</span>
        <span class="n">model_fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">model_fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">()</span>
        <span class="n">yhat</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">yhat</span><span class="p">)</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        <span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;predicted=</span><span class="si">%f</span><span class="s1">, expected=</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">yhat</span><span class="p">,</span> <span class="n">obs</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">predictions</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">newtest7</span> <span class="o">=</span> <span class="n">test_7</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">predict7</span>  <span class="o">=</span> <span class="n">arima_rolling</span><span class="p">(</span><span class="n">train_7</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">newtest7</span><span class="p">,</span> <span class="n">best_order_aic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=78.794335, expected=79.660004
predicted=79.705585, expected=80.599998
predicted=80.622663, expected=80.559998
predicted=80.518277, expected=78.599998
predicted=78.632140, expected=79.029999
predicted=79.048400, expected=78.040001
predicted=77.964630, expected=79.059998
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train_7</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_7</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_7</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">newtest7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_7</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">predict7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forecast&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bfab47ea625cce41e87fa24717f25a850c108277957100f134c99fcc504de441.png" src="_images/bfab47ea625cce41e87fa24717f25a850c108277957100f134c99fcc504de441.png" />
</div>
</div>
</section>
<section id="sin-rolling-forecast">
<h3><strong>Sin rolling forecast</strong><a class="headerlink" href="#sin-rolling-forecast" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norolling7</span> <span class="o">=</span> <span class="n">pmodel</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">test_7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">test_7</span><span class="p">))):</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">test_7</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1"># Valores observados</span>
    <span class="n">predict7</span> <span class="o">=</span> <span class="n">norolling7</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># Predicciones ya alineadas con el test set</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;observaciones: </span><span class="si">{</span><span class="n">obs</span><span class="si">}</span><span class="s1">, prediciones: </span><span class="si">{</span><span class="n">predict7</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>observaciones: 79.66000366210938, prediciones: 79.03278040738911
observaciones: 80.5999984741211, prediciones: 79.0585561746665
observaciones: 80.55999755859375, prediciones: 79.07469912026187
observaciones: 78.5999984741211, prediciones: 79.04556973851643
observaciones: 79.02999877929688, prediciones: 79.04071926936365
observaciones: 78.04000091552734, prediciones: 79.06906751019073
observaciones: 79.05999755859375, prediciones: 79.0638367210078
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train_7</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_7</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_7</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">test_7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_7</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">norolling7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;no rolling&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;date&#39;, ylabel=&#39;close&#39;&gt;
</pre></div>
</div>
<img alt="_images/17ac9be0a6d22470b350b0a67ffbffde079feefd0de297592dc1d2998e874390.png" src="_images/17ac9be0a6d22470b350b0a67ffbffde079feefd0de297592dc1d2998e874390.png" />
</div>
</div>
<p>Podemos observar, que cuando se aplico el modelo con rolling los valores de la predicción ajustan de una manera similar, pero, en cuanto a la parte en donde no se utilizó rolling, no ajusto de la mejor manera, dando como resultado una linea casi recta.</p>
</section>
</section>
<section id="modelo-arima-con-aic-14-dias">
<h2><strong>Modelo ARIMA con aic (14 días)</strong><a class="headerlink" href="#modelo-arima-con-aic-14-dias" title="Link to this heading">#</a></h2>
<p>Realizamos el modelo para predecir los ultimos 14 días</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_walmart</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="p">);</span> <span class="n">n_test_14</span> <span class="o">=</span> <span class="mi">14</span> <span class="c1"># This can be changed</span>
<span class="n">train_size_14</span> <span class="o">=</span> <span class="n">n_walmart</span> <span class="o">-</span> <span class="n">n_test_14</span>
<span class="n">train_14</span> <span class="o">=</span> <span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="p">[:</span><span class="n">train_size_14</span><span class="p">]</span>
<span class="n">dates_train_14</span> <span class="o">=</span> <span class="n">walmartacc_df</span><span class="o">.</span><span class="n">date</span><span class="p">[:</span><span class="n">train_size_14</span><span class="p">]</span>
<span class="n">test_14</span> <span class="o">=</span> <span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="p">[</span><span class="n">train_size_14</span><span class="p">:</span><span class="n">train_size_14</span> <span class="o">+</span> <span class="n">n_test_14</span><span class="p">]</span> 
<span class="n">dates_14</span> <span class="o">=</span> <span class="n">walmartacc_df</span><span class="o">.</span><span class="n">date</span><span class="p">[</span><span class="n">train_size_14</span><span class="p">:</span><span class="n">train_size_14</span> <span class="o">+</span> <span class="n">n_test_14</span><span class="p">]</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;train:&quot;</span><span class="p">,</span> <span class="n">train_14</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;test_4w:&quot;</span><span class="p">,</span> <span class="n">test_14</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>train: (2684,)
test_4w: (14,)
</pre></div>
</div>
</div>
</div>
<section id="con-rolling-forecast">
<h3><strong>Con rolling forecast</strong><a class="headerlink" href="#con-rolling-forecast" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">newtest14</span> <span class="o">=</span> <span class="n">test_14</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">predict14</span>  <span class="o">=</span> <span class="n">arima_rolling</span><span class="p">(</span><span class="n">train_14</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">newtest14</span><span class="p">,</span> <span class="n">best_order_aic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=77.128313, expected=77.169998
predicted=77.283739, expected=77.239998
predicted=77.295536, expected=76.959999
predicted=76.845959, expected=76.639999
predicted=76.631842, expected=77.339996
predicted=77.305975, expected=78.809998
predicted=78.847028, expected=78.839996
predicted=78.794335, expected=79.660004
predicted=79.705585, expected=80.599998
predicted=80.622663, expected=80.559998
predicted=80.518277, expected=78.599998
predicted=78.632140, expected=79.029999
predicted=79.048400, expected=78.040001
predicted=77.964630, expected=79.059998
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train_14</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_14</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">newtest14</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">predict14</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forecast&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0e15d7da1f7e90b12b441c24a6b853f545f8f461b7b0ca7eb60b92f7bc39f36a.png" src="_images/0e15d7da1f7e90b12b441c24a6b853f545f8f461b7b0ca7eb60b92f7bc39f36a.png" />
</div>
</div>
</section>
<section id="id1">
<h3><strong>sin rolling forecast</strong><a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norolling14</span> <span class="o">=</span> <span class="n">pmodel</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">test_14</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">test_14</span><span class="p">))):</span>
    <span class="n">obs14</span> <span class="o">=</span> <span class="n">test_14</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1"># Valores observados</span>
    <span class="n">predict14</span> <span class="o">=</span> <span class="n">norolling14</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># Predicciones ya alineadas con el test set</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;observaciones: </span><span class="si">{</span><span class="n">obs14</span><span class="si">}</span><span class="s1">, prediciones: </span><span class="si">{</span><span class="n">predict14</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>observaciones: 77.16999816894531, prediciones: 79.03278040738911
observaciones: 77.23999786376953, prediciones: 79.0585561746665
observaciones: 76.95999908447266, prediciones: 79.07469912026187
observaciones: 76.63999938964844, prediciones: 79.04556973851643
observaciones: 77.33999633789062, prediciones: 79.04071926936365
observaciones: 78.80999755859375, prediciones: 79.06906751019073
observaciones: 78.83999633789062, prediciones: 79.0638367210078
observaciones: 79.66000366210938, prediciones: 79.03964510713615
observaciones: 80.5999984741211, prediciones: 79.05269516905315
observaciones: 80.55999755859375, prediciones: 79.07040906374458
observaciones: 78.5999984741211, prediciones: 79.05240471177271
observaciones: 79.02999877929688, prediciones: 79.0423176253941
observaciones: 78.04000091552734, prediciones: 79.06225874356238
observaciones: 79.05999755859375, prediciones: 79.06469596211976
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train_14</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_14</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">test_14</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">norolling14</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;no rolling&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;date&#39;, ylabel=&#39;close&#39;&gt;
</pre></div>
</div>
<img alt="_images/3d7be79fc62ce387d1453b40714557f171871473b2d78563ab4ba9786087fc16.png" src="_images/3d7be79fc62ce387d1453b40714557f171871473b2d78563ab4ba9786087fc16.png" />
</div>
</div>
<p>Podemos observar que cuando se hace uso del rolling el modelo ajusta de una buena manera. En cuanto al modelo sin rolling, los errores son significativos ya que siempre suele predecir valores cercanos al mismo número, dando como resultado predicciones que parecen ser una linea.</p>
</section>
</section>
<section id="modelo-arima-con-aic-21-dias">
<h2><strong>Modelo ARIMA con aic (21 días)</strong><a class="headerlink" href="#modelo-arima-con-aic-21-dias" title="Link to this heading">#</a></h2>
<p>Realizamos el modelo para predecir los ultimos 21 días</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_walmart</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="p">);</span> <span class="n">n_test_21</span> <span class="o">=</span> <span class="mi">21</span> <span class="c1"># This can be changed</span>
<span class="n">train_size_21</span> <span class="o">=</span> <span class="n">n_walmart</span> <span class="o">-</span> <span class="n">n_test_21</span>
<span class="n">train_21</span> <span class="o">=</span> <span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="p">[:</span><span class="n">train_size_21</span><span class="p">]</span>
<span class="n">dates_train_21</span> <span class="o">=</span> <span class="n">walmartacc_df</span><span class="o">.</span><span class="n">date</span><span class="p">[:</span><span class="n">train_size_21</span><span class="p">]</span>
<span class="n">test_21</span> <span class="o">=</span> <span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="p">[</span><span class="n">train_size_21</span><span class="p">:</span><span class="n">train_size_21</span> <span class="o">+</span> <span class="n">n_test_21</span><span class="p">]</span> 
<span class="n">dates_21</span> <span class="o">=</span> <span class="n">walmartacc_df</span><span class="o">.</span><span class="n">date</span><span class="p">[</span><span class="n">train_size_21</span><span class="p">:</span><span class="n">train_size_21</span> <span class="o">+</span> <span class="n">n_test_21</span><span class="p">]</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;train:&quot;</span><span class="p">,</span> <span class="n">train_21</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;test_4w:&quot;</span><span class="p">,</span> <span class="n">test_21</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>train: (2677,)
test_4w: (21,)
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h3><strong>Con rolling forecast</strong><a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">newtest21</span> <span class="o">=</span> <span class="n">test_21</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">predict21</span>  <span class="o">=</span> <span class="n">arima_rolling</span><span class="p">(</span><span class="n">train_21</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">newtest21</span><span class="p">,</span> <span class="n">best_order_aic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=75.183895, expected=75.580002
predicted=75.727214, expected=75.699997
predicted=75.702937, expected=76.029999
predicted=75.886918, expected=76.129997
predicted=76.171079, expected=76.080002
predicted=76.199872, expected=76.419998
predicted=76.336309, expected=77.230003
predicted=77.128313, expected=77.169998
predicted=77.283739, expected=77.239998
predicted=77.295536, expected=76.959999
predicted=76.845959, expected=76.639999
predicted=76.631842, expected=77.339996
predicted=77.305975, expected=78.809998
predicted=78.847028, expected=78.839996
predicted=78.794335, expected=79.660004
predicted=79.705585, expected=80.599998
predicted=80.622663, expected=80.559998
predicted=80.518277, expected=78.599998
predicted=78.632140, expected=79.029999
predicted=79.048400, expected=78.040001
predicted=77.964630, expected=79.059998
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train_21</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_21</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_21</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">newtest21</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_21</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">predict21</span><span class="p">)],</span> <span class="n">y</span><span class="o">=</span><span class="n">predict21</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forecast&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f3709181ddaf8b4da8bf07d424b07ca6687c564bb4ffffd3d0fa76cf3d19524a.png" src="_images/f3709181ddaf8b4da8bf07d424b07ca6687c564bb4ffffd3d0fa76cf3d19524a.png" />
</div>
</div>
</section>
<section id="id3">
<h3><strong>Sin rolling forecast</strong><a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norolling21</span> <span class="o">=</span> <span class="n">pmodel</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">test_21</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">test_21</span><span class="p">))):</span>
    <span class="n">obs21</span> <span class="o">=</span> <span class="n">test_21</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1"># Valores observados</span>
    <span class="n">predict21</span> <span class="o">=</span> <span class="n">norolling21</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># Predicciones ya alineadas con el test set</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;observaciones: </span><span class="si">{</span><span class="n">obs21</span><span class="si">}</span><span class="s1">, prediciones: </span><span class="si">{</span><span class="n">predict21</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>observaciones: 75.58000183105469, prediciones: 79.03278040738911
observaciones: 75.69999694824219, prediciones: 79.0585561746665
observaciones: 76.02999877929688, prediciones: 79.07469912026187
observaciones: 76.12999725341797, prediciones: 79.04556973851643
observaciones: 76.08000183105469, prediciones: 79.04071926936365
observaciones: 76.41999816894531, prediciones: 79.06906751019073
observaciones: 77.2300033569336, prediciones: 79.0638367210078
observaciones: 77.16999816894531, prediciones: 79.03964510713615
observaciones: 77.23999786376953, prediciones: 79.05269516905315
observaciones: 76.95999908447266, prediciones: 79.07040906374458
observaciones: 76.63999938964844, prediciones: 79.05240471177271
observaciones: 77.33999633789062, prediciones: 79.0423176253941
observaciones: 78.80999755859375, prediciones: 79.06225874356238
observaciones: 78.83999633789062, prediciones: 79.06469596211976
observaciones: 79.66000366210938, prediciones: 79.04559105837626
observaciones: 80.5999984741211, prediciones: 79.04987839397633
observaciones: 80.55999755859375, prediciones: 79.06592187869558
observaciones: 78.5999984741211, prediciones: 79.05651738396453
observaciones: 79.02999877929688, prediciones: 79.04502576715257
observaciones: 78.04000091552734, prediciones: 79.05756577924113
observaciones: 79.05999755859375, prediciones: 79.06381610712144
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train_21</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_21</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_21</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">test_21</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_21</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">norolling21</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;no rolling&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;date&#39;, ylabel=&#39;close&#39;&gt;
</pre></div>
</div>
<img alt="_images/34c6de745fe1e5236fbeec6a667795634754375efab286419af515df585b65e9.png" src="_images/34c6de745fe1e5236fbeec6a667795634754375efab286419af515df585b65e9.png" />
</div>
</div>
<p>Al igual que en los casos anteriores, las predicciones en donde se hace uso del rolling ajustan y predicen de una buena manera, pero cuando se aplica la tecnica sin rolling el error es bastante grande, dando como resultado valores similares siempre, lo que da como resultado en la grafica una linea casi recta.</p>
</section>
</section>
<section id="modelo-arima-con-aic-28-dias">
<h2><strong>Modelo ARIMA con aic (28 días)</strong><a class="headerlink" href="#modelo-arima-con-aic-28-dias" title="Link to this heading">#</a></h2>
<p>Realizamos el modelo para predecir los ultimos 28 días</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_walmart</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="p">);</span> <span class="n">n_test_28</span> <span class="o">=</span> <span class="mi">28</span> <span class="c1"># This can be changed</span>
<span class="n">train_size_28</span> <span class="o">=</span> <span class="n">n_walmart</span> <span class="o">-</span> <span class="n">n_test_28</span>
<span class="n">train_28</span> <span class="o">=</span> <span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="p">[:</span><span class="n">train_size_28</span><span class="p">]</span>
<span class="n">dates_train_28</span> <span class="o">=</span> <span class="n">walmartacc_df</span><span class="o">.</span><span class="n">date</span><span class="p">[:</span><span class="n">train_size_28</span><span class="p">]</span>
<span class="n">test_28</span> <span class="o">=</span> <span class="n">walmartacc_df</span><span class="o">.</span><span class="n">close</span><span class="p">[</span><span class="n">train_size_28</span><span class="p">:</span><span class="n">train_size_28</span> <span class="o">+</span> <span class="n">n_test_28</span><span class="p">]</span> 
<span class="n">dates_28</span> <span class="o">=</span> <span class="n">walmartacc_df</span><span class="o">.</span><span class="n">date</span><span class="p">[</span><span class="n">train_size_28</span><span class="p">:</span><span class="n">train_size_28</span> <span class="o">+</span> <span class="n">n_test_28</span><span class="p">]</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;train:&quot;</span><span class="p">,</span> <span class="n">train_28</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;test_4w:&quot;</span><span class="p">,</span> <span class="n">test_28</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>train: (2670,)
test_4w: (28,)
</pre></div>
</div>
</div>
</div>
<section id="id4">
<h3><strong>Con rolling forecast</strong><a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">newtest28</span> <span class="o">=</span> <span class="n">test_28</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">predict28</span>  <span class="o">=</span> <span class="n">arima_rolling</span><span class="p">(</span><span class="n">train_28</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">newtest28</span><span class="p">,</span> <span class="n">best_order_aic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=68.663000, expected=68.129997
predicted=68.149877, expected=68.660004
predicted=68.629489, expected=73.180000
predicted=72.987602, expected=73.449997
predicted=73.553117, expected=73.720001
predicted=73.647573, expected=74.540001
predicted=74.389603, expected=75.239998
predicted=75.183895, expected=75.580002
predicted=75.727214, expected=75.699997
predicted=75.702937, expected=76.029999
predicted=75.886918, expected=76.129997
predicted=76.171079, expected=76.080002
predicted=76.199872, expected=76.419998
predicted=76.336309, expected=77.230003
predicted=77.128313, expected=77.169998
predicted=77.283739, expected=77.239998
predicted=77.295536, expected=76.959999
predicted=76.845959, expected=76.639999
predicted=76.631842, expected=77.339996
predicted=77.305975, expected=78.809998
predicted=78.847028, expected=78.839996
predicted=78.794335, expected=79.660004
predicted=79.705585, expected=80.599998
predicted=80.622663, expected=80.559998
predicted=80.518277, expected=78.599998
predicted=78.632140, expected=79.029999
predicted=79.048400, expected=78.040001
predicted=77.964630, expected=79.059998
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train_28</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_28</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_28</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">newtest28</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_28</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">predict28</span><span class="p">)],</span> <span class="n">y</span><span class="o">=</span><span class="n">predict28</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forecast&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a83958994c7a4f26f8f2d90f66551a848b978548fb58eb5037b6da5170e30c7a.png" src="_images/a83958994c7a4f26f8f2d90f66551a848b978548fb58eb5037b6da5170e30c7a.png" />
</div>
</div>
</section>
<section id="id5">
<h3><strong>Sin rolling forecast</strong><a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norolling28</span> <span class="o">=</span> <span class="n">pmodel</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">test_28</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">test_28</span><span class="p">))):</span>
    <span class="n">obs28</span> <span class="o">=</span> <span class="n">test_28</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1"># Valores observados</span>
    <span class="n">predict28</span> <span class="o">=</span> <span class="n">norolling28</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># Predicciones ya alineadas con el test set</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;observaciones: </span><span class="si">{</span><span class="n">obs28</span><span class="si">}</span><span class="s1">, prediciones: </span><span class="si">{</span><span class="n">predict28</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>observaciones: 68.12999725341797, prediciones: 79.03278040738911
observaciones: 68.66000366210938, prediciones: 79.0585561746665
observaciones: 73.18000030517578, prediciones: 79.07469912026187
observaciones: 73.44999694824219, prediciones: 79.04556973851643
observaciones: 73.72000122070312, prediciones: 79.04071926936365
observaciones: 74.54000091552734, prediciones: 79.06906751019073
observaciones: 75.23999786376953, prediciones: 79.0638367210078
observaciones: 75.58000183105469, prediciones: 79.03964510713615
observaciones: 75.69999694824219, prediciones: 79.05269516905315
observaciones: 76.02999877929688, prediciones: 79.07040906374458
observaciones: 76.12999725341797, prediciones: 79.05240471177271
observaciones: 76.08000183105469, prediciones: 79.0423176253941
observaciones: 76.41999816894531, prediciones: 79.06225874356238
observaciones: 77.2300033569336, prediciones: 79.06469596211976
observaciones: 77.16999816894531, prediciones: 79.04559105837626
observaciones: 77.23999786376953, prediciones: 79.04987839397633
observaciones: 76.95999908447266, prediciones: 79.06592187869558
observaciones: 76.63999938964844, prediciones: 79.05651738396453
observaciones: 77.33999633789062, prediciones: 79.04502576715257
observaciones: 78.80999755859375, prediciones: 79.05756577924113
observaciones: 78.83999633789062, prediciones: 79.06381610712144
observaciones: 79.66000366210938, prediciones: 79.05019176241755
observaciones: 80.5999984741211, prediciones: 79.04911438636245
observaciones: 80.55999755859375, prediciones: 79.06196678313732
observaciones: 78.5999984741211, prediciones: 79.05856739406273
observaciones: 79.02999877929688, prediciones: 79.04795033421097
observaciones: 78.04000091552734, prediciones: 79.05468906885598
observaciones: 79.05999755859375, prediciones: 79.06211802615954
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train_28</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_28</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_28</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">test_28</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_28</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">norolling28</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;no rolling&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;date&#39;, ylabel=&#39;close&#39;&gt;
</pre></div>
</div>
<img alt="_images/d43e7ba59fb441d42ce9fa3f38dec430f924d51421610d9cfadea6727ed8e533.png" src="_images/d43e7ba59fb441d42ce9fa3f38dec430f924d51421610d9cfadea6727ed8e533.png" />
</div>
</div>
<p>En esta ocasión podemos ver notablemente el error de la tecnica cuando no se aplica el rolling, ya que no predice los valores de la mejor manera, dando como resultado una linea casi recta, en cambio, cuando se usa rolling los valores predecidos y los del test son bastante similares.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="bic">
<h1><strong>BIC</strong><a class="headerlink" href="#bic" title="Link to this heading">#</a></h1>
<p>Realizamos los procedimientos para el segundo criterio, con los mejores parámetros obtenidos (1,1,1)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smodel</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">walmartacc_df</span><span class="p">[</span><span class="s1">&#39;adjclose&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">)})</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">();</span>
<span class="n">plot_predict</span><span class="p">(</span><span class="n">smodel</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/42b801bf796b69d1cff683f9e647dd5b7086ef2fc04e3f0bac1d237904e25ec1.png" src="_images/42b801bf796b69d1cff683f9e647dd5b7086ef2fc04e3f0bac1d237904e25ec1.png" />
</div>
</div>
<p>En esta ocasión podemos observar que la linea en azul se encuentra dentro del área sombrada, lo que significa que los valores futuros pueden caer dentro de esta área con un 95% de confianza, además, se observa una tendencia ascendente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arima_obj_fit</span><span class="o">.</span><span class="n">plot_diagnostics</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/38f741fb72b79928098dff342db2a210a4c7eec19642da868d057c8a1fe6354c.png" src="_images/38f741fb72b79928098dff342db2a210a4c7eec19642da868d057c8a1fe6354c.png" />
</div>
</div>
<p>Luego de realizar la gráfica anterior, podemos decir que los residuos se distribuyen normalmente y no tienen dependencia entre ellos, ya que no presentan ninguna correlación.</p>
<section id="modelo-arima-con-bic-7-dias">
<h2><strong>Modelo ARIMA con bic (7 días)</strong><a class="headerlink" href="#modelo-arima-con-bic-7-dias" title="Link to this heading">#</a></h2>
<p>Realizamos el modelo para predecir los ultimos 7 días</p>
<section id="id6">
<h3><strong>Con rolling forecast</strong><a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">newtest7_bic</span> <span class="o">=</span> <span class="n">test_7</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">predict7_bic</span>  <span class="o">=</span> <span class="n">arima_rolling</span><span class="p">(</span><span class="n">train_7</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">newtest7_bic</span><span class="p">,</span> <span class="n">best_order_bic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=78.894793, expected=79.660004
predicted=79.686134, expected=80.599998
predicted=80.628519, expected=80.559998
predicted=80.628930, expected=78.599998
predicted=78.733744, expected=79.029999
predicted=79.067121, expected=78.040001
predicted=78.131486, expected=79.059998
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train_7</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_7</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_7</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">newtest7_bic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_7</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">predict7_bic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forecast&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e5e3c3c008063f1e4169b34edc11f9fbd85a08581b1bd476b16233bc4fd1f581.png" src="_images/e5e3c3c008063f1e4169b34edc11f9fbd85a08581b1bd476b16233bc4fd1f581.png" />
</div>
</div>
</section>
<section id="id7">
<h3><strong>Sin rolling forecast</strong><a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norolling7_bic</span> <span class="o">=</span> <span class="n">smodel</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">test_7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">test_7</span><span class="p">))):</span>
    <span class="n">obs_aic</span> <span class="o">=</span> <span class="n">test_7</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1"># Valores observados</span>
    <span class="n">predict7_aic</span> <span class="o">=</span> <span class="n">norolling7_bic</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># Predicciones ya alineadas con el test set</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;observaciones: </span><span class="si">{</span><span class="n">obs_aic</span><span class="si">}</span><span class="s1">, prediciones: </span><span class="si">{</span><span class="n">predict7_aic</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>observaciones: 79.66000366210938, prediciones: 79.02063718943211
observaciones: 80.5999984741211, prediciones: 79.02349555504853
observaciones: 80.55999755859375, prediciones: 79.02328797940402
observaciones: 78.5999984741211, prediciones: 79.02330305362963
observaciones: 79.02999877929688, prediciones: 79.02330195893339
observaciones: 78.04000091552734, prediciones: 79.02330203843066
observaciones: 79.05999755859375, prediciones: 79.02330203265754
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train_7</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_7</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_7</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">test_7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_7</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">norolling7_bic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;no rolling&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;date&#39;, ylabel=&#39;close&#39;&gt;
</pre></div>
</div>
<img alt="_images/3f1c691c90ea2147748fc87f701f054e9657483c91cbefc082463e18a2b90de4.png" src="_images/3f1c691c90ea2147748fc87f701f054e9657483c91cbefc082463e18a2b90de4.png" />
</div>
</div>
</section>
</section>
<section id="modelo-arima-con-bic-14-dias">
<h2><strong>Modelo ARIMA con bic (14 días)</strong><a class="headerlink" href="#modelo-arima-con-bic-14-dias" title="Link to this heading">#</a></h2>
<p>Realizamos el modelo para predecir los ultimos 14 días</p>
<section id="id8">
<h3><strong>Con rolling forecast</strong><a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">newtest14_bic</span> <span class="o">=</span> <span class="n">test_14</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">predict14_bic</span>  <span class="o">=</span> <span class="n">arima_rolling</span><span class="p">(</span><span class="n">train_14</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">newtest14_bic</span><span class="p">,</span> <span class="n">best_order_bic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=77.243612, expected=77.169998
predicted=77.221056, expected=77.239998
predicted=77.285451, expected=76.959999
predicted=77.019086, expected=76.639999
predicted=76.699587, expected=77.339996
predicted=77.357531, expected=78.809998
predicted=78.803334, expected=78.839996
predicted=78.894793, expected=79.660004
predicted=79.686134, expected=80.599998
predicted=80.628519, expected=80.559998
predicted=80.628930, expected=78.599998
predicted=78.733744, expected=79.029999
predicted=79.067121, expected=78.040001
predicted=78.131486, expected=79.059998
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train_14</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_14</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">newtest14_bic</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">predict14_bic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forecast&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b880ea7baf2af13a9170b90cf5f8ed6574ea360a2b02744b0e9542f43351e005.png" src="_images/b880ea7baf2af13a9170b90cf5f8ed6574ea360a2b02744b0e9542f43351e005.png" />
</div>
</div>
</section>
<section id="id9">
<h3><strong>Sin rolling forecast</strong><a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norolling14_bic</span> <span class="o">=</span> <span class="n">smodel</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">test_14</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">test_14</span><span class="p">))):</span>
    <span class="n">obs14_bic</span> <span class="o">=</span> <span class="n">test_14</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1"># Valores observados</span>
    <span class="n">predict14_bic</span> <span class="o">=</span> <span class="n">norolling14_bic</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># Predicciones ya alineadas con el test set</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;observaciones: </span><span class="si">{</span><span class="n">obs14_bic</span><span class="si">}</span><span class="s1">, prediciones: </span><span class="si">{</span><span class="n">predict14_bic</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>observaciones: 77.16999816894531, prediciones: 79.02063718943211
observaciones: 77.23999786376953, prediciones: 79.02349555504853
observaciones: 76.95999908447266, prediciones: 79.02328797940402
observaciones: 76.63999938964844, prediciones: 79.02330305362963
observaciones: 77.33999633789062, prediciones: 79.02330195893339
observaciones: 78.80999755859375, prediciones: 79.02330203843066
observaciones: 78.83999633789062, prediciones: 79.02330203265754
observaciones: 79.66000366210938, prediciones: 79.02330203307679
observaciones: 80.5999984741211, prediciones: 79.02330203304635
observaciones: 80.55999755859375, prediciones: 79.02330203304857
observaciones: 78.5999984741211, prediciones: 79.02330203304841
observaciones: 79.02999877929688, prediciones: 79.02330203304842
observaciones: 78.04000091552734, prediciones: 79.02330203304842
observaciones: 79.05999755859375, prediciones: 79.02330203304842
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train_14</span><span class="p">[</span><span class="o">-</span><span class="mi">170</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_14</span><span class="p">[</span><span class="o">-</span><span class="mi">170</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">test_14</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">norolling14_bic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;no rolling&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;date&#39;, ylabel=&#39;close&#39;&gt;
</pre></div>
</div>
<img alt="_images/47c03931d5adc950c28cf07c420f3a4b28d8290362664e4899bc51ae378ced7b.png" src="_images/47c03931d5adc950c28cf07c420f3a4b28d8290362664e4899bc51ae378ced7b.png" />
</div>
</div>
</section>
</section>
<section id="modelo-arima-con-bic-21-dias">
<h2><strong>Modelo ARIMA con bic (21 días)</strong><a class="headerlink" href="#modelo-arima-con-bic-21-dias" title="Link to this heading">#</a></h2>
<p>Realizamos el modelo para predecir los ultimos 21 días</p>
<section id="id10">
<h3><strong>Con rolling forecast</strong><a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">newtest21_bic</span> <span class="o">=</span> <span class="n">test_21</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">predict21_bic</span>  <span class="o">=</span> <span class="n">arima_rolling</span><span class="p">(</span><span class="n">train_21</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">newtest21_bic</span><span class="p">,</span> <span class="n">best_order_bic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=75.250106, expected=75.580002
predicted=75.607345, expected=75.699997
predicted=75.737393, expected=76.029999
predicted=76.059474, expected=76.129997
predicted=76.169749, expected=76.080002
predicted=76.125941, expected=76.419998
predicted=76.450209, expected=77.230003
predicted=77.243612, expected=77.169998
predicted=77.221056, expected=77.239998
predicted=77.285451, expected=76.959999
predicted=77.019086, expected=76.639999
predicted=76.699587, expected=77.339996
predicted=77.357531, expected=78.809998
predicted=78.803334, expected=78.839996
predicted=78.894793, expected=79.660004
predicted=79.686134, expected=80.599998
predicted=80.628519, expected=80.559998
predicted=80.628930, expected=78.599998
predicted=78.733744, expected=79.029999
predicted=79.067121, expected=78.040001
predicted=78.131486, expected=79.059998
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train_21</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_21</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_21</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">newtest21_bic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_21</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">predict21_bic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forecast&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8551a8fcba90f292ad9058e2bfd771e7a01fa7bdd31e4a5d6e29bc52dccd4b37.png" src="_images/8551a8fcba90f292ad9058e2bfd771e7a01fa7bdd31e4a5d6e29bc52dccd4b37.png" />
</div>
</div>
</section>
<section id="id11">
<h3><strong>Sin rolling forecast</strong><a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norolling21_bic</span> <span class="o">=</span> <span class="n">smodel</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">test_21</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">test_21</span><span class="p">))):</span>
    <span class="n">obs21_bic</span> <span class="o">=</span> <span class="n">test_21</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1"># Valores observados</span>
    <span class="n">predict21_bic</span> <span class="o">=</span> <span class="n">norolling21_bic</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># Predicciones ya alineadas con el test set</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;observaciones: </span><span class="si">{</span><span class="n">obs21_bic</span><span class="si">}</span><span class="s1">, prediciones: </span><span class="si">{</span><span class="n">predict21_bic</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>observaciones: 75.58000183105469, prediciones: 79.02063718943211
observaciones: 75.69999694824219, prediciones: 79.02349555504853
observaciones: 76.02999877929688, prediciones: 79.02328797940402
observaciones: 76.12999725341797, prediciones: 79.02330305362963
observaciones: 76.08000183105469, prediciones: 79.02330195893339
observaciones: 76.41999816894531, prediciones: 79.02330203843066
observaciones: 77.2300033569336, prediciones: 79.02330203265754
observaciones: 77.16999816894531, prediciones: 79.02330203307679
observaciones: 77.23999786376953, prediciones: 79.02330203304635
observaciones: 76.95999908447266, prediciones: 79.02330203304857
observaciones: 76.63999938964844, prediciones: 79.02330203304841
observaciones: 77.33999633789062, prediciones: 79.02330203304842
observaciones: 78.80999755859375, prediciones: 79.02330203304842
observaciones: 78.83999633789062, prediciones: 79.02330203304842
observaciones: 79.66000366210938, prediciones: 79.02330203304842
observaciones: 80.5999984741211, prediciones: 79.02330203304842
observaciones: 80.55999755859375, prediciones: 79.02330203304842
observaciones: 78.5999984741211, prediciones: 79.02330203304842
observaciones: 79.02999877929688, prediciones: 79.02330203304842
observaciones: 78.04000091552734, prediciones: 79.02330203304842
observaciones: 79.05999755859375, prediciones: 79.02330203304842
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train_21</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_21</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_21</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">test_21</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_21</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">norolling21_bic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;no rolling&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;date&#39;, ylabel=&#39;close&#39;&gt;
</pre></div>
</div>
<img alt="_images/6b686a48887065a7aa89b024891a1252f11795c2f845cfb612546e6fe815ea51.png" src="_images/6b686a48887065a7aa89b024891a1252f11795c2f845cfb612546e6fe815ea51.png" />
</div>
</div>
</section>
</section>
<section id="modelo-arima-con-bic-28-dias">
<h2><strong>Modelo ARIMA con bic (28 días)</strong><a class="headerlink" href="#modelo-arima-con-bic-28-dias" title="Link to this heading">#</a></h2>
<p>Realizamos el modelo para predecir los ultimos 28 días</p>
<section id="id12">
<h3><strong>Con rolling forecast</strong><a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">newtest28_bic</span> <span class="o">=</span> <span class="n">test_28</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">predict28_bic</span>  <span class="o">=</span> <span class="n">arima_rolling</span><span class="p">(</span><span class="n">train_28</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">newtest28_bic</span><span class="p">,</span> <span class="n">best_order_bic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=68.685911, expected=68.129997
predicted=68.179935, expected=68.660004
predicted=68.654990, expected=73.180000
predicted=72.996775, expected=73.449997
predicted=73.472463, expected=73.720001
predicted=73.743305, expected=74.540001
predicted=74.541554, expected=75.239998
predicted=75.250106, expected=75.580002
predicted=75.607345, expected=75.699997
predicted=75.737393, expected=76.029999
predicted=76.059474, expected=76.129997
predicted=76.169749, expected=76.080002
predicted=76.125941, expected=76.419998
predicted=76.450209, expected=77.230003
predicted=77.243612, expected=77.169998
predicted=77.221056, expected=77.239998
predicted=77.285451, expected=76.959999
predicted=77.019086, expected=76.639999
predicted=76.699587, expected=77.339996
predicted=77.357531, expected=78.809998
predicted=78.803334, expected=78.839996
predicted=78.894793, expected=79.660004
predicted=79.686134, expected=80.599998
predicted=80.628519, expected=80.559998
predicted=80.628930, expected=78.599998
predicted=78.733744, expected=79.029999
predicted=79.067121, expected=78.040001
predicted=78.131486, expected=79.059998
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train_28</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_28</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_28</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">newtest28_bic</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_28</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">predict28_bic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forecast&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b546a52d25b033434bcfb973b3067887b1c89b5592437ca9a17b4ae8cc2b61ca.png" src="_images/b546a52d25b033434bcfb973b3067887b1c89b5592437ca9a17b4ae8cc2b61ca.png" />
</div>
</div>
</section>
<section id="id13">
<h3><strong>Sin rolling forecast</strong><a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norolling28_bic</span> <span class="o">=</span> <span class="n">smodel</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">test_28</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">test_28</span><span class="p">))):</span>
    <span class="n">obs28_bic</span> <span class="o">=</span> <span class="n">test_28</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1"># Valores observados</span>
    <span class="n">predict28_bic</span> <span class="o">=</span> <span class="n">norolling28_bic</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># Predicciones ya alineadas con el test set</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;observaciones: </span><span class="si">{</span><span class="n">obs28_bic</span><span class="si">}</span><span class="s1">, prediciones: </span><span class="si">{</span><span class="n">predict28_bic</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>observaciones: 68.12999725341797, prediciones: 79.02063718943211
observaciones: 68.66000366210938, prediciones: 79.02349555504853
observaciones: 73.18000030517578, prediciones: 79.02328797940402
observaciones: 73.44999694824219, prediciones: 79.02330305362963
observaciones: 73.72000122070312, prediciones: 79.02330195893339
observaciones: 74.54000091552734, prediciones: 79.02330203843066
observaciones: 75.23999786376953, prediciones: 79.02330203265754
observaciones: 75.58000183105469, prediciones: 79.02330203307679
observaciones: 75.69999694824219, prediciones: 79.02330203304635
observaciones: 76.02999877929688, prediciones: 79.02330203304857
observaciones: 76.12999725341797, prediciones: 79.02330203304841
observaciones: 76.08000183105469, prediciones: 79.02330203304842
observaciones: 76.41999816894531, prediciones: 79.02330203304842
observaciones: 77.2300033569336, prediciones: 79.02330203304842
observaciones: 77.16999816894531, prediciones: 79.02330203304842
observaciones: 77.23999786376953, prediciones: 79.02330203304842
observaciones: 76.95999908447266, prediciones: 79.02330203304842
observaciones: 76.63999938964844, prediciones: 79.02330203304842
observaciones: 77.33999633789062, prediciones: 79.02330203304842
observaciones: 78.80999755859375, prediciones: 79.02330203304842
observaciones: 78.83999633789062, prediciones: 79.02330203304842
observaciones: 79.66000366210938, prediciones: 79.02330203304842
observaciones: 80.5999984741211, prediciones: 79.02330203304842
observaciones: 80.55999755859375, prediciones: 79.02330203304842
observaciones: 78.5999984741211, prediciones: 79.02330203304842
observaciones: 79.02999877929688, prediciones: 79.02330203304842
observaciones: 78.04000091552734, prediciones: 79.02330203304842
observaciones: 79.05999755859375, prediciones: 79.02330203304842
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train_28</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_28</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_28</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">test_28</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_28</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">norolling28_bic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;no rolling&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;date&#39;, ylabel=&#39;close&#39;&gt;
</pre></div>
</div>
<img alt="_images/74cf8c0703477bf3c70847b97758f9ca637da0b6cb80a24d4d909cf6c2dbb47a.png" src="_images/74cf8c0703477bf3c70847b97758f9ca637da0b6cb80a24d4d909cf6c2dbb47a.png" />
</div>
</div>
<p>Tras analizar las gráficas con y sin el uso de rolling para cada uno de los días que queremos predecir, podemos concluir que las predicciones con rolling logran ajustarse mucho mejor al conjunto de prueba, proporcionando valores muy cercanos y reflejando un ajuste más preciso. En cambio, en las predicciones sin rolling, observamos que los valores tienden a mantenerse alrededor de un número constante, lo que genera grandes errores al predecir, resultando en líneas casi rectas debido a la falta de ajuste.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="hqic">
<h1><strong>HQIC</strong><a class="headerlink" href="#hqic" title="Link to this heading">#</a></h1>
<p>En esta ocasión, los valores obtenidos para el criterio AIC fueron iguales, por lo que no es necesario realizar procedimientos adicionales, ya que todo se llevaría a cabo de la misma manera.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="metricas-de-errores">
<h1><strong>Metricas de errores</strong><a class="headerlink" href="#metricas-de-errores" title="Link to this heading">#</a></h1>
<section id="metricas-de-error-usando-rolling-para-el-aic">
<h2><strong>Métricas de error usando rolling para el aic</strong><a class="headerlink" href="#metricas-de-error-usando-rolling-para-el-aic" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">forecast_accuracy</span><span class="p">(</span><span class="n">forecast</span><span class="p">,</span> <span class="n">actual</span><span class="p">,</span> <span class="n">str_name</span><span class="p">):</span>
    
    <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">forecast</span> <span class="o">-</span> <span class="n">actual</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">actual</span><span class="p">))</span> <span class="c1"># MAPE</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">forecast</span> <span class="o">-</span> <span class="n">actual</span><span class="p">))</span>                 <span class="c1"># MAE</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">forecast</span> <span class="o">-</span> <span class="n">actual</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">.5</span>               <span class="c1"># RMSE</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">forecast</span> <span class="o">-</span> <span class="n">actual</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>                    <span class="c1"># MSE</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">forecast</span><span class="p">,</span> <span class="n">actual</span><span class="p">)</span>
    
    <span class="n">df_acc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mae</span><span class="p">],</span>
                           <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mse</span><span class="p">],</span>
                           <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mape</span><span class="p">],</span>
                           <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">rmse</span><span class="p">],</span>
                           <span class="s1">&#39;R2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">r2</span><span class="p">]},</span>
                          <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">str_name</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">df_acc</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas7</span> <span class="o">=</span> <span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">newtest7</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predict7</span><span class="p">),</span> <span class="s2">&quot;7 días&quot;</span><span class="p">)</span>
<span class="n">metricas14</span> <span class="o">=</span> <span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">newtest14</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predict14</span><span class="p">),</span> <span class="s2">&quot;14 días&quot;</span><span class="p">)</span>
<span class="n">metricas21</span> <span class="o">=</span> <span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">newtest21</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predict21</span><span class="p">),</span> <span class="s2">&quot;21 días&quot;</span><span class="p">)</span>
<span class="n">metricas28</span> <span class="o">=</span> <span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">newtest28</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predict28</span><span class="p">),</span> <span class="s2">&quot;28 días&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">metricas7</span><span class="p">,</span><span class="n">metricas14</span><span class="p">,</span> <span class="n">metricas21</span><span class="p">,</span> <span class="n">metricas28</span><span class="p">])</span>
<span class="n">metricas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7 días</th>
      <td>0.891808</td>
      <td>1.086867</td>
      <td>0.011239</td>
      <td>1.042529</td>
      <td>-0.361900</td>
    </tr>
    <tr>
      <th>14 días</th>
      <td>0.649199</td>
      <td>0.752167</td>
      <td>0.008256</td>
      <td>0.867276</td>
      <td>0.511259</td>
    </tr>
    <tr>
      <th>21 días</th>
      <td>0.537483</td>
      <td>0.557594</td>
      <td>0.006882</td>
      <td>0.746722</td>
      <td>0.756216</td>
    </tr>
    <tr>
      <th>28 días</th>
      <td>0.687603</td>
      <td>1.240079</td>
      <td>0.009223</td>
      <td>1.113588</td>
      <td>0.857064</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Podemos decir que el modelo que muestra un mejor desempeñi es el horizonte de 21 días, ya que tienen las métricas más bajas, además de un <span class="math notranslate nohighlight">\(R^2\)</span> positivo y significativo.</p>
</section>
<section id="metricas-de-error-sin-usar-rolling-para-el-aic">
<h2><strong>Métricas de error sin usar rolling para el aic</strong><a class="headerlink" href="#metricas-de-error-sin-usar-rolling-para-el-aic" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas7</span> <span class="o">=</span> <span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">newtest7</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">norolling7</span><span class="p">),</span> <span class="s2">&quot;7 días&quot;</span><span class="p">)</span>
<span class="n">metricas14</span> <span class="o">=</span> <span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">newtest14</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">norolling14</span><span class="p">),</span> <span class="s2">&quot;14 días&quot;</span><span class="p">)</span>
<span class="n">metricas21</span> <span class="o">=</span> <span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">newtest21</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">norolling21</span><span class="p">),</span> <span class="s2">&quot;21 días&quot;</span><span class="p">)</span>
<span class="n">metricas28</span> <span class="o">=</span> <span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">newtest28</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">norolling28</span><span class="p">),</span> <span class="s2">&quot;28 días&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">metricas7</span><span class="p">,</span><span class="n">metricas14</span><span class="p">,</span> <span class="n">metricas21</span><span class="p">,</span> <span class="n">metricas28</span><span class="p">])</span>
<span class="n">metricas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7 días</th>
      <td>0.734737</td>
      <td>0.890458</td>
      <td>0.009293</td>
      <td>0.943641</td>
      <td>-0.115789</td>
    </tr>
    <tr>
      <th>14 días</th>
      <td>1.109584</td>
      <td>1.878089</td>
      <td>0.014036</td>
      <td>1.370434</td>
      <td>-0.220339</td>
    </tr>
    <tr>
      <th>21 días</th>
      <td>1.702439</td>
      <td>4.116307</td>
      <td>0.021535</td>
      <td>2.028868</td>
      <td>-0.799678</td>
    </tr>
    <tr>
      <th>28 días</th>
      <td>2.936287</td>
      <td>15.820280</td>
      <td>0.037143</td>
      <td>3.977472</td>
      <td>-0.823499</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>De estas métricas se puede concluir que el desempeño del modelo es deficiente, en especial en horizontes de tiempo más largos, además, que el <span class="math notranslate nohighlight">\(R^2\)</span> negativo indica que el modelo no es el adecuado.</p>
</section>
<section id="metricas-de-error-usando-rolling-para-el-bic">
<h2><strong>Métricas de error usando rolling para el bic</strong><a class="headerlink" href="#metricas-de-error-usando-rolling-para-el-bic" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas7</span> <span class="o">=</span> <span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">newtest7</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predict7_bic</span><span class="p">),</span> <span class="s2">&quot;7 días&quot;</span><span class="p">)</span>
<span class="n">metricas14</span> <span class="o">=</span> <span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">newtest14</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predict14_bic</span><span class="p">),</span> <span class="s2">&quot;14 días&quot;</span><span class="p">)</span>
<span class="n">metricas21</span> <span class="o">=</span> <span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">newtest21</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predict21_bic</span><span class="p">),</span> <span class="s2">&quot;21 días&quot;</span><span class="p">)</span>
<span class="n">metricas28</span> <span class="o">=</span> <span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">newtest28</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predict28_bic</span><span class="p">),</span> <span class="s2">&quot;28 días&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">metricas7</span><span class="p">,</span><span class="n">metricas14</span><span class="p">,</span> <span class="n">metricas21</span><span class="p">,</span> <span class="n">metricas28</span><span class="p">])</span>
<span class="n">metricas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7 días</th>
      <td>0.861202</td>
      <td>1.078118</td>
      <td>0.010831</td>
      <td>1.038325</td>
      <td>-0.350937</td>
    </tr>
    <tr>
      <th>14 días</th>
      <td>0.639646</td>
      <td>0.737383</td>
      <td>0.008124</td>
      <td>0.858710</td>
      <td>0.520865</td>
    </tr>
    <tr>
      <th>21 días</th>
      <td>0.519253</td>
      <td>0.534951</td>
      <td>0.006637</td>
      <td>0.731403</td>
      <td>0.766116</td>
    </tr>
    <tr>
      <th>28 días</th>
      <td>0.666472</td>
      <td>1.201372</td>
      <td>0.008935</td>
      <td>1.096071</td>
      <td>0.861526</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Este modelo, muestra un redimiento creciente, con las métricas más bajas en el horizonte de 21 días. Este modelo es más efectivo para predicciones entre 14 y 21 días.</p>
</section>
<section id="metricas-de-error-sin-usar-rolling-para-el-bic">
<h2><strong>Métricas de error sin usar rolling para el bic</strong><a class="headerlink" href="#metricas-de-error-sin-usar-rolling-para-el-bic" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas7</span> <span class="o">=</span> <span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">newtest7</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">norolling7_bic</span><span class="p">),</span> <span class="s2">&quot;7 días&quot;</span><span class="p">)</span>
<span class="n">metricas14</span> <span class="o">=</span> <span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">newtest14</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">norolling14_bic</span><span class="p">),</span> <span class="s2">&quot;14 días&quot;</span><span class="p">)</span>
<span class="n">metricas21</span> <span class="o">=</span> <span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">newtest21</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">norolling21_bic</span><span class="p">),</span> <span class="s2">&quot;21 días&quot;</span><span class="p">)</span>
<span class="n">metricas28</span> <span class="o">=</span> <span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">newtest28</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">norolling28_bic</span><span class="p">),</span> <span class="s2">&quot;28 días&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">metricas7</span><span class="p">,</span><span class="n">metricas14</span><span class="p">,</span> <span class="n">metricas21</span><span class="p">,</span> <span class="n">metricas28</span><span class="p">])</span>
<span class="n">metricas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7 días</th>
      <td>0.743225</td>
      <td>0.914727</td>
      <td>0.009405</td>
      <td>0.956413</td>
      <td>-0.146199</td>
    </tr>
    <tr>
      <th>14 días</th>
      <td>1.097195</td>
      <td>1.846850</td>
      <td>0.013885</td>
      <td>1.358988</td>
      <td>-0.200041</td>
    </tr>
    <tr>
      <th>21 días</th>
      <td>1.683517</td>
      <td>4.035041</td>
      <td>0.021304</td>
      <td>2.008741</td>
      <td>-0.764148</td>
    </tr>
    <tr>
      <th>28 días</th>
      <td>2.914177</td>
      <td>15.660898</td>
      <td>0.036878</td>
      <td>3.957385</td>
      <td>-0.805128</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Este modelo presenta un rendimiento deficiente, ya que a medida que aumentan los horizontes tambien aumentan las métricas de error, además que en todos se presentan un <span class="math notranslate nohighlight">\(R^2\)</span> negativo.</p>
</section>
<section id="correlacion-entre-la-observacion-real-y-prediccion-del-test-en-aic">
<h2><strong>Correlación entre la observación real y predicción del test en AIC</strong><a class="headerlink" href="#correlacion-entre-la-observacion-real-y-prediccion-del-test-en-aic" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1">#(7 días)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">test_7</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">predict7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#8A2BE2&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;7 días&#39;</span><span class="p">)</span>

<span class="c1"># (14 días)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">test_14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">predict14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#8A2BE2&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;14 días&#39;</span><span class="p">)</span>

<span class="c1"># (21 días)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">test_21</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">predict21</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#8A2BE2&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;21 días&#39;</span><span class="p">)</span>

<span class="c1"># (28 días)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">test_28</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">predict28</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#8A2BE2&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;28 días&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/916c580a76d073368c34922bd8a7facd6cebe1529670e67333d20805b97f0dfc.png" src="_images/916c580a76d073368c34922bd8a7facd6cebe1529670e67333d20805b97f0dfc.png" />
</div>
</div>
<p>Luego de efectuar las gráficas anteriores, podemos observar que en las predicciones de los 7 días no se presenta ninguna correlación, pero las predicciones del los 28 días aparentemente se ve una correlación significativa.</p>
</section>
<section id="correlacion-entre-la-observacion-real-y-prediccion-del-test-en-bic">
<h2><strong>Correlación entre la observación real y predicción del test en BIC</strong><a class="headerlink" href="#correlacion-entre-la-observacion-real-y-prediccion-del-test-en-bic" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1">#(7 días)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">test_7</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">predict7_bic</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#8A2BE2&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;7 días&#39;</span><span class="p">)</span>

<span class="c1"># (14 días)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">test_14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">predict14_bic</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#8A2BE2&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;14 días&#39;</span><span class="p">)</span>

<span class="c1"># (21 días)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">test_21</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">predict21_bic</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#8A2BE2&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;21 días&#39;</span><span class="p">)</span>

<span class="c1"># (28 días)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">test_28</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">predict28_bic</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#8A2BE2&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;28 días&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7f8370722056942401f0207d626b2c85283eafc70fa159a51e52da1854b39297.png" src="_images/7f8370722056942401f0207d626b2c85283eafc70fa159a51e52da1854b39297.png" />
</div>
</div>
<p>Al igual que las gráficas anteriores, en las predicciones de los 7 días no se observa ninguna correlación, pero en las graficas de 21 días y 28 días se observan valores un poco más agrupados, lo que podría significar algún tipo de correlación entre ellos.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Actividad Series de Tiempo - Walmart</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>Actividad Serie de tiempo</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-y-analisis-descriptivo"><strong>Datos y análisis descriptivo</strong></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-arima"><strong>Modelo ARIMA</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estacionariedad"><strong>Estacionariedad</strong></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#aic"><strong>AIC</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#residuos"><strong>Residuos</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-arima-con-aic-7-dias"><strong>modelo ARIMA con aic (7 días)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rolling-forecast"><strong>rolling forecast</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sin-rolling-forecast"><strong>Sin rolling forecast</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-arima-con-aic-14-dias"><strong>Modelo ARIMA con aic (14 días)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#con-rolling-forecast"><strong>Con rolling forecast</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><strong>sin rolling forecast</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-arima-con-aic-21-dias"><strong>Modelo ARIMA con aic (21 días)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><strong>Con rolling forecast</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>Sin rolling forecast</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-arima-con-aic-28-dias"><strong>Modelo ARIMA con aic (28 días)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><strong>Con rolling forecast</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><strong>Sin rolling forecast</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bic"><strong>BIC</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-arima-con-bic-7-dias"><strong>Modelo ARIMA con bic (7 días)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><strong>Con rolling forecast</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><strong>Sin rolling forecast</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-arima-con-bic-14-dias"><strong>Modelo ARIMA con bic (14 días)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><strong>Con rolling forecast</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><strong>Sin rolling forecast</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-arima-con-bic-21-dias"><strong>Modelo ARIMA con bic (21 días)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><strong>Con rolling forecast</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11"><strong>Sin rolling forecast</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-arima-con-bic-28-dias"><strong>Modelo ARIMA con bic (28 días)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"><strong>Con rolling forecast</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13"><strong>Sin rolling forecast</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hqic"><strong>HQIC</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-errores"><strong>Metricas de errores</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-error-usando-rolling-para-el-aic"><strong>Métricas de error usando rolling para el aic</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-error-sin-usar-rolling-para-el-aic"><strong>Métricas de error sin usar rolling para el aic</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-error-usando-rolling-para-el-bic"><strong>Métricas de error usando rolling para el bic</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-error-sin-usar-rolling-para-el-bic"><strong>Métricas de error sin usar rolling para el bic</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlacion-entre-la-observacion-real-y-prediccion-del-test-en-aic"><strong>Correlación entre la observación real y predicción del test en AIC</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlacion-entre-la-observacion-real-y-prediccion-del-test-en-bic"><strong>Correlación entre la observación real y predicción del test en BIC</strong></a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Gwyneth BLanco Durán
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>